<html>
<head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>MySqlå­¦ä¹ ä¹‹è·¯(åå››)ï¼šæ€§èƒ½åˆ†æå·¥ä½œçš„ä½¿ç”¨ | é¸¡æ¯›è’œçš®äº‹(â—&#39;â—¡&#39;â—)</title>

<link rel="shortcut icon" href="http://mofish.pily.life/favicon.ico?v=1689146956047">

<link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet">
<link rel="stylesheet" href="http://mofish.pily.life/styles/main.css">
<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css"> -->

<style>
    hr {
        margin-top: 1rem;
        margin-bottom: 1rem;
        border: 0;
        border-top: 1px solid rgba(0, 0, 0, 0.1);
    }
</style>

<script src="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dockerfile.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dart.min.js"></script>

<!-- <script src="https://cdn.jsdelivr.net/npm/moment@2.27.0/moment.min.js"></script> -->
<!-- <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script> -->
<!-- <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script> -->
<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.min.js"></script> -->
<!-- DEMO JS -->
<!--<script src="media/scripts/index.js"></script>-->


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.css">
</head>
<body>
<div class="main gt-bg-theme-color-first">
    <style>
    /* å¯¼èˆªæ æ ·å¼ */
    .navbar {
        position: relative;
        display: -ms-flexbox;
        display: flex;
        -ms-flex-wrap: wrap;
        flex-wrap: wrap;
        -ms-flex-align: center;
        align-items: center;
        -ms-flex-pack: justify;
        justify-content: space-between;
        padding: 0.5rem 1rem;
    }

    .navbar-brand {
        display: inline-block;
        padding-top: 0.3125rem;
        padding-bottom: 0.3125rem;
        margin-right: 1rem;
        font-size: 1.25rem;
        line-height: inherit;
        white-space: nowrap;
    }

    .navbar-brand:hover,
    .navbar-brand:focus {
        text-decoration: none;
    }

    .navbar-nav {
        display: -ms-flexbox;
        display: flex;
        -ms-flex-direction: column;
        flex-direction: column;
        padding-left: 0;
        margin-bottom: 0;
        list-style: none;
    }

    .navbar-collapse {
        -ms-flex-preferred-size: 100%;
        flex-basis: 100%;
        -ms-flex-positive: 1;
        flex-grow: 1;
        -ms-flex-align: center;
        align-items: center;
    }

    .navbar-toggler {
        padding: 0.25rem 0.75rem;
        font-size: 1.25rem;
        line-height: 1;
        background-color: transparent;
        border: 1px solid transparent;
        border-radius: 0.25rem;
    }

    .navbar-toggler:hover,
    .navbar-toggler:focus {
        text-decoration: none;
    }

    @media (min-width: 992px) {
        .navbar-expand-lg {
            -ms-flex-flow: row nowrap;
            flex-flow: row nowrap;
            -ms-flex-pack: start;
            justify-content: flex-start;
        }

        .navbar-expand-lg .navbar-nav {
            -ms-flex-direction: row;
            flex-direction: row;
        }

        .navbar-expand-lg .navbar-collapse {
            display: -ms-flexbox !important;
            display: flex !important;
            -ms-flex-preferred-size: auto;
            flex-basis: auto;
        }

        .navbar-expand-lg .navbar-toggler {
            display: none;
        }
    }

    @media (max-width: 991px) {
        #navbarSupportedContent {
            display: none;
        }
    }
</style>
<nav class="navbar navbar-expand-lg">
    <div class="navbar-brand">
        <img class="user-avatar" src="/images/avatar.png" alt="å¤´åƒ">
        <div class="site-name gt-c-content-color-first">
            é¸¡æ¯›è’œçš®äº‹(â—&#39;â—¡&#39;â—)
        </div>
    </div>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <i class="fas fa-bars gt-c-content-color-first" style="font-size: 18px"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <div class="navbar-nav mr-auto" style="text-align: center">
            
            <div class="nav-item">
                
                <a href="/" class="menu gt-a-link">
                    é¦–é¡µ
                </a>
                
            </div>
            
            <div class="nav-item">
                
                <a href="/tags" class="menu gt-a-link">
                    æ ‡ç­¾
                </a>
                
            </div>
            
            <div class="nav-item">
                
                <a href="/archives" class="menu gt-a-link">
                    å½’æ¡£
                </a>
                
            </div>
            
            <div class="nav-item">
                
                <a href="/post/about" class="menu gt-a-link">
                    å…³äº
                </a>
                
            </div>
            
        </div>
        <div style="text-align: center">
            <form id="gridea-search-form" style="position: relative" data-update="1689146956047"
                action="/search/index.html">
                <input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="æœç´¢æ–‡ç« " />
                <i class="fas fa-search gt-c-content-color-first" style="position: absolute; top: 9px; left: 10px;"></i>
            </form>
        </div>
    </div>
</nav>
<script>
    /* ç§»åŠ¨ç«¯å¯¼èˆªæ å±•å¼€/æ”¶èµ·åˆ‡æ¢ */
    document.getElementById('changeNavbar').onclick = function () {
        var element = document.getElementById('navbarSupportedContent');
        if (element.style.display === 'none' || element.style.display === '') {
            element.style.display = 'block';
        } else {
            element.style.display = 'none';
        }
    }
</script>
    <div class="post-container">
        <div class="post-detail gt-bg-theme-color-second">
            <article class="gt-post-content">
                <h2 class="post-title">
                    MySqlå­¦ä¹ ä¹‹è·¯(åå››)ï¼šæ€§èƒ½åˆ†æå·¥ä½œçš„ä½¿ç”¨
                </h2>
                <div class="post-info">
                    <time class="post-time gt-c-content-color-first">
                        Â· 2022-12-28 Â·
                    </time>
                    
                        <a href="http://mofish.pily.life/tag/YVLEbqd3K/" class="post-tags">
                            # mysql
                        </a>
                    
                </div>
                <div class="post-content">
                    <p>åœ¨æ•°æ®åº“è°ƒä¼˜ä¸­ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ <code>å“åº”æ—¶é—´æ›´å¿«, ååé‡æ›´å¤§</code> ã€‚åˆ©ç”¨å®è§‚çš„ç›‘æ§å·¥å…·å’Œå¾®è§‚çš„æ—¥å¿—åˆ†æå¯ä»¥å¸®æˆ‘ä»¬å¿«é€Ÿæ‰¾åˆ°è°ƒä¼˜çš„æ€è·¯å’Œæ–¹å¼ã€‚</p>
<!-- more -->
<h1 id="ç›®å½•">ç›®å½•</h1>
<ul>
<li><a href='#ä¸€ã€æ•°æ®åº“æœåŠ¡å™¨çš„ä¼˜åŒ–æ­¥éª¤'>ä¸€ã€æ•°æ®åº“æœåŠ¡å™¨çš„ä¼˜åŒ–æ­¥éª¤</a></li>
<li><a href='#äºŒã€æŸ¥çœ‹ç³»ç»Ÿæ€§èƒ½å‚æ•°'>äºŒã€æŸ¥çœ‹ç³»ç»Ÿæ€§èƒ½å‚æ•°</a></li>
<li><a href='#ä¸‰ã€ç»Ÿè®¡SQLçš„æŸ¥è¯¢æˆæœ¬ï¼šlast_query_cost'>ä¸‰ã€ç»Ÿè®¡SQLçš„æŸ¥è¯¢æˆæœ¬ï¼šlast_query_cost</a></li>
<li><a href='#å››ã€å®šä½æŸ¥è¯¢æ…¢çš„SQLï¼šæ…¢æŸ¥è¯¢æ—¥å¿—'>å››ã€å®šä½æŸ¥è¯¢æ…¢çš„SQLï¼šæ…¢æŸ¥è¯¢æ—¥å¿—</a></li>
<li><a href='#äº”ã€åˆ†ææŸ¥è¯¢è¯­å¥ï¼šEXPLAIN'>äº”ã€åˆ†ææŸ¥è¯¢è¯­å¥ï¼šEXPLAIN</a></li>
<li><a href='#å…­ã€åˆ†æä¼˜åŒ–å™¨æ‰§è¡Œè®¡åˆ’ï¼štrace'>å…­ã€åˆ†æä¼˜åŒ–å™¨æ‰§è¡Œè®¡åˆ’ï¼štrace</a></li>
<li><a href='#ä¸ƒã€MySqlç›‘æ§åˆ†æè§†å›¾-sys schema'>ä¸ƒã€MySqlç›‘æ§åˆ†æè§†å›¾-sys schema</a></li>
<li><a href='#å°ç»“'>å°ç»“</a></li>
</ul>
<hr>
<h1 id="a-nameä¸€-æ•°æ®åº“æœåŠ¡å™¨çš„ä¼˜åŒ–æ­¥éª¤ä¸€-æ•°æ®åº“æœåŠ¡å™¨çš„ä¼˜åŒ–æ­¥éª¤a"><a name='ä¸€ã€æ•°æ®åº“æœåŠ¡å™¨çš„ä¼˜åŒ–æ­¥éª¤'>ä¸€ã€æ•°æ®åº“æœåŠ¡å™¨çš„ä¼˜åŒ–æ­¥éª¤</a></h1>
<p>æ•´ä¸ªæµç¨‹åˆ’åˆ†æˆäº†<code>è§‚å¯Ÿï¼ˆShow statusï¼‰</code>å’Œ<code>è¡ŒåŠ¨ï¼ˆActionï¼‰</code>ä¸¤ä¸ªéƒ¨åˆ†ã€‚å­—æ¯Sçš„éƒ¨åˆ†ä»£è¡¨è§‚å¯Ÿ<code>ï¼ˆä¼šä½¿ç”¨å¯¹åº”çš„åˆ†æå·¥å…·ï¼‰</code>ï¼Œå­—æ¯Açš„éƒ¨åˆ†ä»£è¡¨è¡ŒåŠ¨<code>ï¼ˆå¯¹åº”åˆ†æå¯ä»¥é‡‡å–çš„è¡ŒåŠ¨ï¼‰</code>ã€‚<br>
<img src="http://mofish.pily.life/post-images/1672211010372.png" alt="" loading="lazy"></p>
<p>S1ï¼šæˆ‘ä»¬éœ€è¦è§‚å¯ŸæœåŠ¡å™¨çš„çŠ¶æ€æ˜¯å¦å­˜åœ¨å‘¨æœŸæ€§æ³¢åŠ¨ï¼Œå¦‚æœ<code>å­˜åœ¨å‘¨æœŸæ€§æ³¢åŠ¨</code>ï¼Œæœ‰å¯èƒ½æ˜¯å‘¨æœŸæ€§èŠ‚ç‚¹çš„åŸå› ï¼Œæ¯”å¦‚åŒåä¸€ã€ä¿ƒé”€æ´»åŠ¨ç­‰ã€‚è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡A1è¿™ä¸€æ­¥è§£å†³ï¼Œå°±æ˜¯åŠ ç¼“å­˜æˆ–æ›´æ”¹ç¼“å­˜å¤±æ•ˆç­–ç•¥ã€‚</p>
<p>S2ï¼šå¦‚æœä¸æ˜¯ä¸Šè¿°åŸå› ï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦è¿›ä¸€æ­¥<code>åˆ†æå»¶è¿Ÿå’Œå¡é¡¿çš„åŸå› </code>ï¼Œåœ¨S2è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬éœ€è¦<code>å¼€å¯æ…¢æŸ¥è¯¢</code>ã€‚æ…¢æŸ¥è¯¢å¯ä»¥å¸®æˆ‘ä»¬å®šä½æ‰§è¡Œæ…¢çš„SQLè¯­å¥ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®<code>long_query_time</code>å‚æ•°å®šä¹‰â€œæ…¢â€çš„é˜ˆå€¼ï¼Œå½“æ”¶é›†ä¸Šæ¥è¿™äº›æ…¢æŸ¥è¯¢ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡åˆ†æå·¥ä½œå¯¹æ…¢æŸ¥è¯¢æ—¥å¿—è¿›è¡Œåˆ†æã€‚</p>
<p>S3ï¼šå½“æˆ‘ä»¬çŸ¥é“äº†æ‰§è¡Œæ…¢çš„SQLåï¼Œå°±å¯ä»¥ä½¿ç”¨<code>EXPLAIN</code>æŸ¥çœ‹å¯¹åº”çš„SQLè¯­å¥çš„æ‰§è¡Œè®¡åˆ’ï¼Œæˆ–è€…ä½¿ç”¨<code>show profile</code>æŸ¥è¯¢SQLä¸­æ¯ä¸€ä¸ªæ­¥éª¤çš„æ—¶é—´æˆæœ¬ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥äº†è§£SQLæŸ¥è¯¢æ…¢æ˜¯å› ä¸º<code>æ‰§è¡Œæ—¶é—´é•¿</code>è¿˜æ˜¯<code>ç­‰å¾…æ—¶é—´é•¿</code>äº†ã€‚</p>
<p>A2ï¼šå¦‚æœæ˜¯SQLç­‰å¾…æ—¶é—´é•¿ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒä¼˜æœåŠ¡å™¨çš„å‚æ•°ï¼Œæ¯”å¦‚é€‚å½“å¢åŠ æ•°æ®åº“ç¼“å†²æ± ç­‰ã€‚</p>
<p>A3ï¼šå¦‚æœæ˜¯SQLæ‰§è¡Œæ—¶é—´é•¿ï¼Œé¦–å…ˆè€ƒè™‘çš„æ˜¯ç´¢å¼•è®¾è®¡çš„é—®é¢˜ï¼Œç„¶åçœ‹çœ‹æ˜¯å¦è”è¡¨è¿‡å¤šæˆ–è€…æ˜¯è¡¨ç»“æ„è®¾è®¡æœ‰ç¼ºé™·ç­‰ç­‰ã€‚</p>
<p>A4ï¼šå¦‚æœA2å’ŒA3éƒ½ä¸èƒ½è§£å†³é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘æ•°æ®è‡ªèº«çš„æ€§èƒ½æ˜¯å¦å·²ç»è¾¾åˆ°äº†ç“¶é¢ˆï¼Œå¦‚æœç¡®è®¤æ²¡æœ‰åˆ°è¾¾ç“¶é¢ˆé‚£ä¹ˆä¹…éœ€è¦é‡æ–°æ£€æŸ¥ä¸€ä¸‹ã€‚å¦‚æœå·²ç»åˆ°è¾¾äº†æ€§èƒ½ç“¶é¢ˆï¼Œé‚£ä¹ˆå°±éœ€è¦è€ƒè™‘å¢åŠ æœåŠ¡å™¨ï¼Œé‡‡ç”¨è¯»å†™åˆ†ç¦»çš„æ¶æ„ï¼Œæˆ–è€…è€ƒè™‘å¯¹æ•°æ®è¿›è¡Œåˆ†åº“åˆ†è¡¨ç­‰æ“ä½œäº†ã€‚</p>
<blockquote>
<p>ä»¥ä¸Šå°±æ˜¯æ•°æ®åº“è°ƒä¼˜çš„æµç¨‹æ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è§‚å¯Ÿäº†è§£æ•°æ®åº“æ•´ä½“çš„è¿è¡ŒçŠ¶æ€ï¼Œé€šè¿‡æ€§èƒ½åˆ†æå·¥å…·å¯ä»¥è®©æˆ‘ä»¬äº†è§£æ‰§è¡Œæ…¢çš„SQLéƒ½æœ‰å“ªäº›ï¼ŒæŸ¥çœ‹å…·ä½“çš„SQLæ‰§è¡Œè®¡åˆ’ï¼Œç”šè‡³æ˜¯SQLæ‰§è¡Œä¸­çš„æ¯ä¸€æ­¥çš„æˆæœ¬ä»£ä»·ï¼Œè¿™æ ·æ‰èƒ½å®šä½é—®é¢˜æ‰€åœ¨ï¼Œæ‰¾åˆ°äº†é—®é¢˜ï¼Œå†é‡‡å–ç›¸åº”çš„è¡ŒåŠ¨ã€‚</p>
<p>è¿™ä¸‰ç§åˆ†æå·¥å…·å¯ä»¥ç†è§£æ˜¯SQLè°ƒä¼˜çš„ä¸‰ä¸ªæ­¥éª¤ï¼š<code>æ…¢æŸ¥è¯¢</code>ã€<code>EXPLAIN</code>å’Œ<code>SHOW PROFILING</code>ã€‚</p>
</blockquote>
<figure data-type="image" tabindex="1"><img src="http://mofish.pily.life/post-images/1672215457472.png" alt="" loading="lazy"></figure>
<hr>
<h1 id="a-nameäºŒ-æŸ¥çœ‹ç³»ç»Ÿæ€§èƒ½å‚æ•°äºŒ-æŸ¥çœ‹ç³»ç»Ÿæ€§èƒ½å‚æ•°a"><a name='äºŒã€æŸ¥çœ‹ç³»ç»Ÿæ€§èƒ½å‚æ•°'>äºŒã€æŸ¥çœ‹ç³»ç»Ÿæ€§èƒ½å‚æ•°</a></h1>
<p>åœ¨MySqlä¸­ï¼Œå¯ä»¥ä½¿ç”¨SHOW STATUSè¯­å¥æŸ¥è¯¢ä¸€äº›MySqlæ•°æ®åº“æœåŠ¡å™¨çš„æ€§èƒ½å‚æ•°ã€æ‰§è¡Œé¢‘ç‡ã€‚</p>
<pre><code class="language-sql">SHOW [GLOBAL] STATUS LIKE 'å‚æ•°';
</code></pre>
<p>ä¸€äº›æ€§èƒ½å‚æ•°å¦‚ä¸‹ï¼š</p>
<ul>
<li>Connectionsï¼šè¿æ¥MySQLæœåŠ¡å™¨çš„æ¬¡æ•°ã€‚</li>
<li>Uptimeï¼šMySQLæœåŠ¡å™¨çš„ä¸Šçº¿æ—¶é—´ã€‚</li>
<li>Slow_queriesï¼šæ…¢æŸ¥è¯¢çš„æ¬¡æ•°ã€‚</li>
<li>Innodb_rows_readï¼šSelectæŸ¥è¯¢è¿”å›çš„è¡Œæ•°</li>
<li>Innodb_rows_insertedï¼šæ‰§è¡ŒINSERTæ“ä½œæ’å…¥çš„è¡Œæ•°</li>
<li>Innodb_rows_updatedï¼šæ‰§è¡ŒUPDATEæ“ä½œæ›´æ–°çš„ è¡Œæ•°</li>
<li>Innodb_rows_deletedï¼šæ‰§è¡ŒDELETEæ“ä½œåˆ é™¤çš„è¡Œæ•°</li>
<li>Com_selectï¼šæŸ¥è¯¢æ“ä½œçš„æ¬¡æ•°ã€‚</li>
<li>Com_insertï¼šæ’å…¥æ“ä½œçš„æ¬¡æ•°ã€‚å¯¹äºæ‰¹é‡æ’å…¥çš„ INSERT æ“ä½œï¼Œåªç´¯åŠ ä¸€æ¬¡ã€‚</li>
<li>Com_updateï¼šæ›´æ–°æ“ä½œ çš„æ¬¡æ•°ã€‚</li>
<li>Com_deleteï¼šåˆ é™¤æ“ä½œçš„æ¬¡æ•°ã€‚</li>
</ul>
<hr>
<h1 id="a-nameä¸‰-ç»Ÿè®¡sqlçš„æŸ¥è¯¢æˆæœ¬last_query_costä¸‰-ç»Ÿè®¡sqlçš„æŸ¥è¯¢æˆæœ¬last_query_costa"><a name='ä¸‰ã€ç»Ÿè®¡SQLçš„æŸ¥è¯¢æˆæœ¬ï¼šlast_query_cost'>ä¸‰ã€ç»Ÿè®¡SQLçš„æŸ¥è¯¢æˆæœ¬ï¼šlast_query_cost</a></h1>
<p>ä¸€æ¡SQLæŸ¥è¯¢è¯­å¥åœ¨æ‰§è¡Œå‰éœ€è¦æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’ï¼Œå¦‚æœå­˜åœ¨å¤šç§æ‰§è¡Œè®¡åˆ’çš„è¯ï¼ŒMySqlå›è®¡ç®—æ¯ä¸ªæ‰§è¡Œè®¡åˆ’æ‰€éœ€çš„æˆæœ¬ï¼Œä»ä¸­é€‰æ‹©<code>æˆæœ¬æœ€å°</code>çš„ä¸€ä¸ªä½œä¸ºæœ€ç»ˆæ‰§è¡Œçš„æ‰§è¡Œè®¡åˆ’ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬æƒ³è¦æŸ¥çœ‹æŸæ¡SQLè¯­å¥çš„æŸ¥è¯¢æˆæœ¬ï¼Œå¯ä»¥åœ¨<code>æ‰§è¡Œå®Œè¿™æ¡SQLè¯­å¥ä¹‹å</code>ï¼Œé€šè¿‡æŸ¥çœ‹å½“å‰ä¼šè¯ä¸­çš„<code>last_query_cost</code>å˜é‡å€¼æ¥å¾—åˆ°å½“å‰æŸ¥è¯¢çš„æˆæœ¬ã€‚å®ƒé€šå¸¸ä¹Ÿæ˜¯æˆ‘ä»¬<code>è¯„ä»·ä¸€ä¸ªæŸ¥è¯¢æ‰§è¡Œæ•ˆç‡å¸¸ç”¨æŒ‡æ ‡</code>ã€‚è¿™ä¸ªæŸ¥è¯¢æˆæœ¬å¯¹åº”çš„æ˜¯<code>SQLè¯­å¥æ‰€éœ€è¦è¯»å–çš„é¡µçš„æ•°é‡</code>ã€‚</p>
<pre><code class="language-sql">-- æ„å»ºæ•°æ®è¡¨
CREATE TABLE `student_info` (
    `id` INT(11) NOT NULL AUTO_INCREMENT,
    `student_id` INT NOT NULL ,
    `name` VARCHAR(20) DEFAULT NULL,
    `course_id` INT NOT NULL ,
    `class_id` INT(11) DEFAULT NULL,
    `create_time` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    PRIMARY KEY (`id`)
) ENGINE=INNODB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;

-- æŸ¥è¯¢ä¸€æ¡è®°å½•
SELECT student_id, class_id, NAME, create_time FROM student_info WHERE id = 900001;

SHOW STATUS LIKE 'last_query_cost';
+-----------------+----------+
| Variable_name   |   Value  |
+-----------------+----------+
| Last_query_cost | 1.000000 |
+-----------------+----------+

-- æŸ¥è¯¢å¤šæ¡è®°å½•
SELECT student_id, class_id, NAME, create_time FROM student_info WHERE id BETWEEN 900001 AND 900100;

SHOW STATUS LIKE 'last_query_cost';
+-----------------+-----------+
| Variable_name   |   Value   |
+-----------------+-----------+
| Last_query_cost | 21.134453 |
+-----------------+-----------+
</code></pre>
<p>è™½ç„¶çœ‹åˆ°é¡µçš„æ•°é‡æ˜¯ç¬¬ä¸€æ¬¡æŸ¥è¯¢çš„20å€ï¼Œä½†æ˜¯æŸ¥è¯¢çš„æ•ˆç‡å¹¶æ²¡æœ‰æ˜æ˜¾çš„å˜åŒ–ï¼Œå®é™…ä¸Šè¿™ä¸¤ä¸ªSQLçš„æŸ¥è¯¢æ—¶é—´åŸºæœ¬æ˜¯ä¸€æ ·çš„ï¼Œå°±æ˜¯å› ä¸ºé‡‡å–äº†é¡ºåºè¯»å–å¾—æ–¹å¼ï¼Œè®²é¡µé¢ä¸€æ¬¡æ€§åŠ è½½åˆ°ç¼“å†²æ± ï¼Œç„¶åå†è¿›è¡ŒæŸ¥æ‰¾ã€‚è™½ç„¶é¡µçš„æ•°é‡å¢åŠ äº†ï¼Œä½†æ˜¯é€šè¿‡ç¼“å†²æ± çš„æœºåˆ¶ï¼Œå¹¶æ²¡æœ‰å¢åŠ å¤šå°‘æŸ¥è¯¢æ—¶é—´ã€‚</p>
<blockquote>
<p>SQLæŸ¥è¯¢æ—¶ä¸€ä¸ªåŠ¨æ€çš„è¿‡ç¨‹ï¼Œä»é¡µåŠ è½½çš„è§’åº¦æ¥çœ‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä»¥ä¸‹ä¸¤ç‚¹ç»“è®ºï¼š</p>
<ol>
<li>
<p><code>ä½ç½®å†³å®šæ•ˆç‡</code>ã€‚å¦‚æœé¡µå°±åœ¨æ•°æ®åº“çš„<code>ç¼“å†²æ± </code>ä¸­ï¼Œé‚£ä¹ˆæ•ˆç‡æœ€é«˜ï¼Œå¦åˆ™è¿˜éœ€è¦ä»ç£ç›˜ä¸­è¯»å–æ•°æ®å¹¶åŠ è½½åˆ°å†…å­˜ä¸­ã€‚</p>
</li>
<li>
<p><code>æ‰¹é‡å†³å®šæ•ˆç‡</code>ã€‚å¦‚æœæˆ‘ä»¬ä»ç£ç›˜å¯¹å•ä¸€é¡µè¿›è¡Œéšæœºè¯»ï¼Œé‚£ä¹ˆæ•ˆç‡æ˜¯ä½ä¸‹çš„ï¼Œè€Œé‡‡ç”¨é¡ºåºè¯»å–çš„æ–¹å¼ï¼Œæ‰¹é‡å¯¹é¡µè¿›è¡Œè¯»å–ï¼Œé‚£ä¹ˆå¹³å‡ä¸€é¡µçš„è¯»å–æ•ˆç‡å°±ä¼šæå‡å¾ˆå¤šï¼Œç”šè‡³å¿«äºå•ä¸ªé¡µé¢åœ¨å†…å­˜ä¸­çš„éšæœºè¯»å–ã€‚</p>
</li>
</ol>
</blockquote>
<hr>
<h1 id="a-nameå››-å®šä½æŸ¥è¯¢æ…¢çš„sqlæ…¢æŸ¥è¯¢æ—¥å¿—å››-å®šä½æŸ¥è¯¢æ…¢çš„sqlæ…¢æŸ¥è¯¢æ—¥å¿—a"><a name='å››ã€å®šä½æŸ¥è¯¢æ…¢çš„SQLï¼šæ…¢æŸ¥è¯¢æ—¥å¿—'>å››ã€å®šä½æŸ¥è¯¢æ…¢çš„SQLï¼šæ…¢æŸ¥è¯¢æ—¥å¿—</a></h1>
<p>look thisğŸ‘‰ğŸ‘‰ğŸ‘‰ğŸ‘‰<a href='/post/mysql_learning_15'>ã€ŠMySqlå­¦ä¹ ä¹‹è·¯(åäº”)ï¼šæ…¢æŸ¥è¯¢æ—¥å¿—ã€‹</a></p>
<hr>
<h1 id="a-nameäº”-åˆ†ææŸ¥è¯¢è¯­å¥explainäº”-åˆ†ææŸ¥è¯¢è¯­å¥explaina"><a name='äº”ã€åˆ†ææŸ¥è¯¢è¯­å¥ï¼šEXPLAIN'>äº”ã€åˆ†ææŸ¥è¯¢è¯­å¥ï¼šEXPLAIN</a></h1>
<p>look thisğŸ‘‰ğŸ‘‰ğŸ‘‰ğŸ‘‰<a href='/post/mysql_learning_06'>ã€ŠMysqlå­¦ä¹ ä¹‹è·¯(å…­)ï¼šexplainæ‰§è¡Œè®¡åˆ’è¯¦è§£ã€‹</a></p>
<hr>
<h1 id="a-nameå…­-åˆ†æä¼˜åŒ–å™¨æ‰§è¡Œè®¡åˆ’traceå…­-åˆ†æä¼˜åŒ–å™¨æ‰§è¡Œè®¡åˆ’tracea"><a name='å…­ã€åˆ†æä¼˜åŒ–å™¨æ‰§è¡Œè®¡åˆ’ï¼štrace'>å…­ã€åˆ†æä¼˜åŒ–å™¨æ‰§è¡Œè®¡åˆ’ï¼štrace</a></h1>
<p><code>OPTIMIZER_TRACE</code>æ˜¯MySql5.6å¼•å…¥çš„ä¸€é¡¹è·Ÿè¸ªåŠŸèƒ½ï¼Œå®ƒå¯ä»¥è·Ÿè¸ªä¼˜åŒ–å™¨åšå‡ºçš„å„ç§å†³ç­–ï¼ˆæ¯”å¦‚è®¿é—®è¡¨çš„æ–¹æ³•ã€å„ç§å¼€é”€è®¡ç®—ã€å„ç§è½¬æ¢ç­‰ï¼‰ï¼Œå¹¶å°†è·Ÿè¸ªè®°å½•ç»“æœè®°å½•åˆ°<code>INFORMATION_SCHEMA.OPTIMIZER_TRACE</code>è¡¨ä¸­ã€‚</p>
<p>æ­¤åŠŸèƒ½<code>é»˜è®¤å…³é—­</code>ã€‚å¼€å¯traceï¼Œå¹¶è®¾ç½®æ ¼å¼æœªJSONï¼ŒåŒäº‹è®¾ç½®traceæœ€å¤§èƒ½å¤Ÿä½¿ç”¨çš„å†…å­˜å¤§å°ï¼Œé¿å…è§£æè¿‡ç¨‹ä¸­å› é»˜è®¤å†…å­˜è¿‡å°è€Œä¸èƒ½å¤Ÿå®Œæ•´å±•ç¤ºã€‚</p>
<pre><code class="language-sql">SET optimizer_trace=&quot;enabled=on&quot;,end_markers_in_json=on;
SET optimizer_trace_max_mem_size=1000000;
</code></pre>
<p>å¼€å¯åï¼Œå¯åˆ†æå¦‚ä¸‹è¯­å¥ï¼š</p>
<ul>
<li>SELECT</li>
<li>INSERT</li>
<li>REPLACE</li>
<li>UPDATE</li>
<li>DELETE</li>
<li>EXPLAIN</li>
<li>SET</li>
<li>DECLARE</li>
<li>CASE</li>
<li>IF</li>
<li>RETURN</li>
<li>CALL</li>
</ul>
<pre><code class="language-sql">-- æµ‹è¯•è¯­å¥
select * from student where id &lt; 10;

-- æŸ¥è¯¢ information_schema.optimizer_trace
select * from information_schema.optimizer_trace\G

*************************** 1. row ***************************
//ç¬¬1éƒ¨åˆ†ï¼šæŸ¥è¯¢è¯­å¥
QUERY: select * from student where id &lt; 10
//ç¬¬2éƒ¨åˆ†ï¼šQUERYå­—æ®µå¯¹åº”è¯­å¥çš„è·Ÿè¸ªä¿¡æ¯
TRACE: {
&quot;steps&quot;: [
{
    &quot;join_preparation&quot;: { //é¢„å¤‡å·¥ä½œ
        &quot;select#&quot;: 1,
        &quot;steps&quot;: [
            {
            &quot;expanded_query&quot;: &quot;/* select#1 */ select `student`.`id` AS
            `id`,`student`.`stuno` AS `stuno`,`student`.`name` AS `name`,`student`.`age` AS
            `age`,`student`.`classId` AS `classId` from `student` where (`student`.`id` &lt; 10)&quot;
            }
        ] /* steps */
    } /* join_preparation */
},
{
    &quot;join_optimization&quot;: { //è¿›è¡Œä¼˜åŒ–
    &quot;select#&quot;: 1,
    &quot;steps&quot;: [
        {
        &quot;condition_processing&quot;: { //æ¡ä»¶å¤„ç†
        &quot;condition&quot;: &quot;WHERE&quot;,
        &quot;original_condition&quot;: &quot;(`student`.`id` &lt; 10)&quot;,
        &quot;steps&quot;: [
        {
            &quot;transformation&quot;: &quot;equality_propagation&quot;,
            &quot;resulting_condition&quot;: &quot;(`student`.`id` &lt; 10)&quot;
        },
        {
            &quot;transformation&quot;: &quot;constant_propagation&quot;,
            &quot;resulting_condition&quot;: &quot;(`student`.`id` &lt; 10)&quot;
        },
        {
            &quot;transformation&quot;: &quot;trivial_condition_removal&quot;,
            &quot;resulting_condition&quot;: &quot;(`student`.`id` &lt; 10)&quot;
        }
        ] /* steps */
    } /* condition_processing */
    },
    {
        &quot;substitute_generated_columns&quot;: { //æ›¿æ¢ç”Ÿæˆçš„åˆ—
        } /* substitute_generated_columns */
    },
    {
        &quot;table_dependencies&quot;: [ //è¡¨çš„ä¾èµ–å…³ç³»
        {
            &quot;table&quot;: &quot;`student`&quot;,
            &quot;row_may_be_null&quot;: false,
            &quot;map_bit&quot;: 0,
            &quot;depends_on_map_bits&quot;: [
            ] /* depends_on_map_bits */
        }
    ] /* table_dependencies */
    },
    {
    &quot;ref_optimizer_key_uses&quot;: [ //ä½¿ç”¨é”®
        ] /* ref_optimizer_key_uses */
        },
    {
        &quot;rows_estimation&quot;: [ //è¡Œåˆ¤æ–­
        {
            &quot;table&quot;: &quot;`student`&quot;,
            &quot;range_analysis&quot;: {
                &quot;table_scan&quot;: {
                    &quot;rows&quot;: 3973767,
                    &quot;cost&quot;: 408558
            } /* table_scan */, //æ‰«æè¡¨
            &quot;potential_range_indexes&quot;: [ //æ½œåœ¨çš„èŒƒå›´ç´¢å¼•
                {
                    &quot;index&quot;: &quot;PRIMARY&quot;,
                    &quot;usable&quot;: true,
                    &quot;key_parts&quot;: [
                    &quot;id&quot;
                    ] /* key_parts */
                }
            ] /* potential_range_indexes */,
        &quot;setup_range_conditions&quot;: [ //è®¾ç½®èŒƒå›´æ¡ä»¶
        ] /* setup_range_conditions */,
        &quot;group_index_range&quot;: {
            &quot;chosen&quot;: false,
            &quot;cause&quot;: &quot;not_group_by_or_distinct&quot;
        } /* group_index_range */,
            &quot;skip_scan_range&quot;: {
                &quot;potential_skip_scan_indexes&quot;: [
                    {
                        &quot;index&quot;: &quot;PRIMARY&quot;,
                        &quot;usable&quot;: false,
                        &quot;cause&quot;: &quot;query_references_nonkey_column&quot;
                    }
                ] /* potential_skip_scan_indexes */
            } /* skip_scan_range */,
        &quot;analyzing_range_alternatives&quot;: { //åˆ†æèŒƒå›´é€‰é¡¹
            &quot;range_scan_alternatives&quot;: [
                {
                &quot;index&quot;: &quot;PRIMARY&quot;,
                    &quot;ranges&quot;: [
                        &quot;id &lt; 10&quot;
                    ] /* ranges */,
                &quot;index_dives_for_eq_ranges&quot;: true,
                &quot;rowid_ordered&quot;: true,
                &quot;using_mrr&quot;: false,
                &quot;index_only&quot;: false,
                &quot;rows&quot;: 9,
                &quot;cost&quot;: 1.91986,
                &quot;chosen&quot;: true
                }
            ] /* range_scan_alternatives */,
        &quot;analyzing_roworder_intersect&quot;: {
            &quot;usable&quot;: false,
            &quot;cause&quot;: &quot;too_few_roworder_scans&quot;
            } /* analyzing_roworder_intersect */
        } /* analyzing_range_alternatives */,
        &quot;chosen_range_access_summary&quot;: { //é€‰æ‹©èŒƒå›´è®¿é—®æ‘˜è¦
            &quot;range_access_plan&quot;: {
                &quot;type&quot;: &quot;range_scan&quot;,
                &quot;index&quot;: &quot;PRIMARY&quot;,
                &quot;rows&quot;: 9,
                &quot;ranges&quot;: [
                &quot;id &lt; 10&quot;
                ] /* ranges */
                } /* range_access_plan */,
                &quot;rows_for_plan&quot;: 9,
                &quot;cost_for_plan&quot;: 1.91986,
                &quot;chosen&quot;: true
                } /* chosen_range_access_summary */
                } /* range_analysis */
            }
        ] /* rows_estimation */
    },
    {
    &quot;considered_execution_plans&quot;: [ //è€ƒè™‘æ‰§è¡Œè®¡åˆ’
    {
    &quot;plan_prefix&quot;: [
    ] /* plan_prefix */,
        &quot;table&quot;: &quot;`student`&quot;,
        &quot;best_access_path&quot;: { //æœ€ä½³è®¿é—®è·¯å¾„
        &quot;considered_access_paths&quot;: [
        {
            &quot;rows_to_scan&quot;: 9,
            &quot;access_type&quot;: &quot;range&quot;,
            &quot;range_details&quot;: {
            &quot;used_index&quot;: &quot;PRIMARY&quot;
        } /* range_details */,
        &quot;resulting_rows&quot;: 9,
        &quot;cost&quot;: 2.81986,
        &quot;chosen&quot;: true
    }
    ] /* considered_access_paths */
    } /* best_access_path */,
        &quot;condition_filtering_pct&quot;: 100, //è¡Œè¿‡æ»¤ç™¾åˆ†æ¯”
        &quot;rows_for_plan&quot;: 9,
        &quot;cost_for_plan&quot;: 2.81986,
        &quot;chosen&quot;: true
    }
    ] /* considered_execution_plans */
    },
    {
        &quot;attaching_conditions_to_tables&quot;: { //å°†æ¡ä»¶é™„åŠ åˆ°è¡¨ä¸Š
        &quot;original_condition&quot;: &quot;(`student`.`id` &lt; 10)&quot;,
        &quot;attached_conditions_computation&quot;: [
        ] /* attached_conditions_computation */,
        &quot;attached_conditions_summary&quot;: [ //é™„åŠ æ¡ä»¶æ¦‚è¦
    {
        &quot;table&quot;: &quot;`student`&quot;,
        &quot;attached&quot;: &quot;(`student`.`id` &lt; 10)&quot;
    }
    ] /* attached_conditions_summary */
    } /* attaching_conditions_to_tables */
    },
    {
    &quot;finalizing_table_conditions&quot;: [
    {
        &quot;table&quot;: &quot;`student`&quot;,
        &quot;original_table_condition&quot;: &quot;(`student`.`id` &lt; 10)&quot;,
        &quot;final_table_condition &quot;: &quot;(`student`.`id` &lt; 10)&quot;
    }
    ] /* finalizing_table_conditions */
    },
    {
    &quot;refine_plan&quot;: [ //ç²¾ç®€è®¡åˆ’
    {
        &quot;table&quot;: &quot;`student`&quot;
    }
    ] /* refine_plan */
    }
    ] /* steps */
    } /* join_optimization */
},
    {
        &quot;join_execution&quot;: { //æ‰§è¡Œ
            &quot;select#&quot;: 1,
            &quot;steps&quot;: [
            ] /* steps */
            } /* join_execution */
        }
    ] /* steps */
}
//ç¬¬3éƒ¨åˆ†ï¼šè·Ÿè¸ªä¿¡æ¯è¿‡é•¿æ—¶ï¼Œè¢«æˆªæ–­çš„è·Ÿè¸ªä¿¡æ¯çš„å­—èŠ‚æ•°ã€‚
MISSING_BYTES_BEYOND_MAX_MEM_SIZE: 0 //ä¸¢å¤±çš„è¶…å‡ºæœ€å¤§å®¹é‡çš„å­—èŠ‚
//ç¬¬4éƒ¨åˆ†ï¼šæ‰§è¡Œè·Ÿè¸ªè¯­å¥çš„ç”¨æˆ·æ˜¯å¦æœ‰æŸ¥çœ‹å¯¹è±¡çš„æƒé™ã€‚å½“ä¸å…·æœ‰æƒé™æ—¶ï¼Œè¯¥åˆ—ä¿¡æ¯ä¸º1ä¸”TRACEå­—æ®µä¸ºç©ºï¼Œä¸€èˆ¬åœ¨
è°ƒç”¨å¸¦æœ‰SQL SECURITY DEFINERçš„è§†å›¾æˆ–è€…æ˜¯å­˜å‚¨è¿‡ç¨‹çš„æƒ…å†µä¸‹ï¼Œä¼šå‡ºç°æ­¤é—®é¢˜ã€‚
INSUFFICIENT_PRIVILEGES: 0 //ç¼ºå¤±æƒé™
1 row in set (0.00 sec)
</code></pre>
<hr>
<h1 id="a-nameä¸ƒ-mysqlç›‘æ§åˆ†æè§†å›¾-sys-schemaä¸ƒ-mysqlç›‘æ§åˆ†æè§†å›¾-sys-schemaa"><a name='ä¸ƒã€MySqlç›‘æ§åˆ†æè§†å›¾-sys schema'>ä¸ƒã€MySqlç›‘æ§åˆ†æè§†å›¾-sys schema</a></h1>
<p>å…³äºMySqlçš„æ€§èƒ½ç›‘æ§å’Œé—®é¢˜è¯Šæ–­ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½ä»performance_schemaä¸­å»è·å–æƒ³è¦çš„æ•°æ®ï¼Œåœ¨MySql5.7ç‰ˆæœ¬ä¸­æ–°å¢sys schemaï¼Œå®ƒè®²performance_schemaå’Œinformation_schemaä¸­çš„æ•°æ®ä»¥æ›´å®¹æ˜“ç†è§£çš„æ–¹å¼æ€»ç»“å½’çº³ä¸ºâ€œè§†å›¾â€ï¼Œå…¶ç›®çš„å°±æ˜¯ä¸ºäº†é™ä½æŸ¥è¯¢performation_schemaçš„å¤æ‚åº¦ï¼Œè®©DBAèƒ½å¤Ÿå¿«é€Ÿçš„å®šä½é—®é¢˜ã€‚</p>
<p><strong>Sys schemaè§†å›¾æ‘˜è¦ï¼š</strong></p>
<ul>
<li><strong>ä¸»æœºç›¸å…³</strong>ï¼šä»¥host_summaryå¼€å¤´ï¼Œä¸»è¦æ±‡æ€»äº†IOå»¶è¿Ÿçš„ä¿¡æ¯ã€‚</li>
<li><strong>Innodbç›¸å…³</strong>ï¼šä»¥innodbå¼€å¤´ï¼Œæ±‡æ€»äº†innodb bufferä¿¡æ¯å’Œäº‹åŠ¡ç­‰å¾…innodbé”çš„ä¿¡æ¯ã€‚</li>
<li><strong>I/oç›¸å…³</strong>ï¼šä»¥ioå¼€å¤´ï¼Œæ±‡æ€»äº†ç­‰å¾…I/Oã€I/Oä½¿ç”¨é‡æƒ…å†µã€‚</li>
<li><strong>å†…å­˜ä½¿ç”¨æƒ…å†µ</strong>ï¼šä»¥memoryå¼€å¤´ï¼Œä»ä¸»æœºã€çº¿ç¨‹ã€äº‹ä»¶ç­‰è§’åº¦å±•ç¤ºå†…å­˜çš„ä½¿ç”¨æƒ…å†µ</li>
<li><strong>è¿æ¥ä¸ä¼šè¯ä¿¡æ¯</strong>ï¼šprocesslistå’Œsessionç›¸å…³è§†å›¾ï¼Œæ€»ç»“äº†ä¼šè¯ç›¸å…³ä¿¡æ¯ã€‚</li>
<li><strong>è¡¨ç›¸å…³</strong>ï¼šä»¥schema_tableå¼€å¤´çš„è§†å›¾ï¼Œå±•ç¤ºäº†è¡¨çš„ç»Ÿè®¡ä¿¡æ¯ã€‚</li>
<li><strong>ç´¢å¼•ä¿¡æ¯</strong>ï¼šç»Ÿè®¡äº†ç´¢å¼•çš„ä½¿ç”¨æƒ…å†µï¼ŒåŒ…å«å†—ä½™ç´¢å¼•å’Œæœªä½¿ç”¨çš„ç´¢å¼•æƒ…å†µã€‚</li>
<li><strong>è¯­å¥ç›¸å…³</strong>ï¼šä»¥statementå¼€å¤´ï¼ŒåŒ…å«æ‰§è¡Œå…¨è¡¨æ‰«æã€ä½¿ç”¨ä¸´æ—¶è¡¨ã€æ’åºç­‰çš„è¯­å¥ä¿¡æ¯ã€‚</li>
<li><strong>ç”¨æˆ·ç›¸å…³</strong>ï¼šä»¥userå¼€å¤´çš„è§†å›¾ï¼Œç»Ÿè®¡äº†ç”¨æˆ·ä½¿ç”¨çš„æ–‡ä»¶I/Oã€æ‰§è¡Œè¯­å¥ç»Ÿè®¡ä¿¡æ¯ã€‚</li>
<li><strong>ç­‰å¾…äº‹ä»¶ç›¸å…³ä¿¡æ¯</strong>ï¼šä»¥waitå¼€å¤´ï¼Œå±•ç¤ºç­‰å¾…äº‹ä»¶çš„å»¶è¿Ÿæƒ…å†µã€‚</li>
</ul>
<br>
<p><strong>Sys schemaè§†å›¾æ‘˜è¦ï¼š</strong></p>
<pre><code class="language-sql">-- ç´¢å¼•æƒ…å†µ
#1. æŸ¥è¯¢å†—ä½™ç´¢å¼•
select * from sys.schema_redundant_indexes;
#2. æŸ¥è¯¢æœªä½¿ç”¨è¿‡çš„ç´¢å¼•
select * from sys.schema_unused_indexes;
#3. æŸ¥è¯¢ç´¢å¼•çš„ä½¿ç”¨æƒ…å†µ
select index_name,rows_selected,rows_inserted,rows_updated,rows_deleted
from sys.schema_index_statistics where table_schema='dbname';

-- è¡¨ç›¸å…³
# 1. æŸ¥è¯¢è¡¨çš„è®¿é—®é‡
select table_schema,table_name,sum(io_read_requests+io_write_requests) as io from
sys.schema_table_statistics group by table_schema,table_name order by io desc;
# 2. æŸ¥è¯¢å ç”¨bufferpoolè¾ƒå¤šçš„è¡¨
select object_schema,object_name,allocated,data
from sys.innodb_buffer_stats_by_table order by allocated limit 10;
# 3. æŸ¥çœ‹è¡¨çš„å…¨è¡¨æ‰«ææƒ…å†µ
select * from sys.statements_with_full_table_scans where db='dbname';

-- è¯­å¥ç›¸å…³
#1. ç›‘æ§SQLæ‰§è¡Œçš„é¢‘ç‡
select db,exec_count,query from sys.statement_analysis
order by exec_count desc;
#2. ç›‘æ§ä½¿ç”¨äº†æ’åºçš„SQL
select db,exec_count,first_seen,last_seen,query
from sys.statements_with_sorting limit 1;
#3. ç›‘æ§ä½¿ç”¨äº†ä¸´æ—¶è¡¨æˆ–è€…ç£ç›˜ä¸´æ—¶è¡¨çš„SQL
select db,exec_count,tmp_tables,tmp_disk_tables,query
from sys.statement_analysis where tmp_tables&gt;0 or tmp_disk_tables &gt;0
order by (tmp_tables+tmp_disk_tables) desc;

-- IOç›¸å…³
#1. æŸ¥çœ‹æ¶ˆè€—ç£ç›˜IOçš„æ–‡ä»¶
select file,avg_read,avg_write,avg_read+avg_write as avg_io
from sys.io_global_by_file_by_bytes order by avg_read limit 10;

-- Innodb ç›¸å…³
#1. è¡Œé”é˜»å¡æƒ…å†µ
select * from sys.innodb_lock_waits;
</code></pre>
<blockquote>
<p><strong>é£é™©æç¤ºï¼š</strong></p>
<p>é€šè¿‡sysåº“å»æŸ¥è¯¢æ—¶ï¼ŒMySqlä¼š<code>æ¶ˆè€—å¤§é‡èµ„æº</code>åŒºæ”¶é›†ç›¸å…³ä¿¡æ¯ï¼Œä¸¥é‡çš„å¯èƒ½ä¼šå¯¼è‡´ä¸šåŠ¡è¯·æ±‚è¢«é˜»å¡ï¼Œä»è€Œå¼•èµ·æ•…éšœã€‚å»ºè®®ç”Ÿäº§ä¸Š<code>ä¸è¦é¢‘ç¹</code>çš„åŒºæŸ¥è¯¢sysæˆ–è€…performance_schemaã€information_schemaæ¥å®Œæˆç›‘æ§ã€å·¡æ£€ç­‰å·¥ä½œã€‚</p>
</blockquote>
<hr>
<h1 id="a-nameå°ç»“å°ç»“a"><a name='å°ç»“'>å°ç»“</a></h1>
<p>æŸ¥è¯¢æ˜¯æ•°æ®åº“ä¸­æœ€é¢‘ç¹çš„æ“ä½œï¼Œæé«˜æŸ¥è¯¢é€Ÿåº¦å¯ä»¥æœ‰æ•ˆåœ°æé«˜MySqlæ•°æ®åº“çš„æ€§èƒ½ã€‚é€šè¿‡å¯¹æŸ¥è¯¢è¯­å¥çš„åˆ†æå¯ä»¥äº†è§£æŸ¥è¯¢è¯­å¥çš„æ‰§è¡Œæƒ…å†µï¼Œæ‰¾å‡ºæŸ¥è¯¢è¯­å¥æ‰§è¡Œçš„ç“¶é¢ˆï¼Œä»è€Œä¼˜åŒ–æŸ¥è¯¢è¯­å¥ã€‚</p>

                </div>
            </article>
        </div>

        
            <div class="next-post">
                <div class="next gt-c-content-color-first">ä¸‹ä¸€ç¯‡</div>
                <a href="http://mofish.pily.life/post/mysql_learning_13/" class="post-title gt-a-link">
                    MySqlå­¦ä¹ ä¹‹è·¯(åä¸‰)ï¼šInnoDBæ•°æ®å­˜å‚¨ç»“æ„
                </a>
            </div>
        

        

        

        

        <div class="site-footer gt-c-content-color-first">
    <div class="slogan gt-c-content-color-first">æ‰“å·¥äººï¼æ‰“å·¥é­‚ï¼æˆ‘çˆ±æ‰“å·¥ï¼</div>
    <div class="social-container">
        
            
        
            
        
            
        
            
        
            
        
            
        
    </div>
    <div class="footer-info">
        Powered by <a href="https://github.com/myx1002/myx1002.github.io" target="_blank">Moyuxing</a>
    </div>
    <div>
        Theme by <a href="https://imhanjie.com/" target="_blank">imhanjie</a>, Powered by <a
                href="https://github.com/getgridea/gridea" target="_blank">Gridea | <a href="http://mofish.pily.life/atom.xml" target="_blank">RSS</a></a>
    </div>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>

    </div>
</div>
</body>
</html>
